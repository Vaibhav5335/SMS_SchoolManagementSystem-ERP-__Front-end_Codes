<!DOCTYPE html>
<html lang="en" class="h-full scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <title>Academic Stats - Parent Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />

  <script src="https://cdn.tailwindcss.com"></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
          colors: {
            brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 900: '#1e3a8a' }
          },
          animation: {
            'fade-in-up': 'fadeInUp 0.6s ease-out forwards',
          },
          keyframes: {
            fadeInUp: {
              '0%': { opacity: '0', transform: 'translateY(10px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            }
          }
        }
      }
    }
  </script>

  <style>
    .scrollbar-hide::-webkit-scrollbar { display: none; }
    .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    /* Focus styles */
    *:focus-visible { outline: 2px solid #3b82f6; outline-offset: 2px; }
  </style>
</head>

<body class="min-h-screen bg-slate-50 text-slate-800 antialiased dark:bg-[#0f172a] dark:text-slate-200 transition-colors duration-300 pb-12">

  <div id="appShell"></div>

  <main class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in-up">

    <header class="mb-8 flex flex-col sm:flex-row sm:items-end justify-between gap-4">
      <div>
        <div class="flex items-center gap-2 mb-2">
          <span class="inline-block w-2 h-2 rounded-full bg-purple-500 animate-pulse"></span>
          <p class="text-[11px] tracking-[0.2em] font-bold text-slate-500 dark:text-slate-400 uppercase">
            Academic Dashboard
          </p>
        </div>
        <h1 class="text-3xl sm:text-4xl font-extrabold text-slate-900 dark:text-white tracking-tight">
          Academic Performance
        </h1>
        <p class="text-sm sm:text-base text-slate-600 dark:text-slate-400 mt-2 max-w-2xl leading-relaxed">
          Track your academic progress, attendance, assignments, and upcoming deadlines.
        </p>
      </div>

      <div class="flex gap-3">
        <div class="relative">
          <select class="appearance-none bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 py-2.5 pl-4 pr-10 rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-500 focus:outline-none shadow-sm">
            <option>2025 - 2026</option>
            <option>2024 - 2025</option>
            <option>2023 - 2024</option>
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-500">
            <i class="fas fa-chevron-down text-xs"></i>
          </div>
        </div>
        <button class="px-4 py-2.5 bg-brand-500 hover:bg-brand-600 text-white font-bold rounded-xl text-sm transition-colors duration-200 flex items-center gap-2">
          <i class="fas fa-download text-xs"></i>
          Report
        </button>
      </div>
    </header>

    <section class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Overall Percentile</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-slate-900 dark:text-white">92%</span>
          <span class="text-xs font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-500/10 px-1.5 py-0.5 rounded">+5%</span>
        </div>
      </article>

      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Attendance</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-slate-900 dark:text-white">88%</span>
          <span class="text-xs font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-500/10 px-1.5 py-0.5 rounded">+2%</span>
        </div>
      </article>

      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Assignments</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-slate-900 dark:text-white">85%</span>
          <span class="text-xs font-bold text-slate-400">Completed</span>
        </div>
      </article>

      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Rank</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-purple-600 dark:text-purple-400">#03</span>
          <span class="text-xs font-bold text-slate-400">/45</span>
        </div>
      </article>
    </section>

    <!-- Additional Academic Metrics -->
    <section class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Pending Assignments</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-slate-900 dark:text-white">1</span>
          <span class="text-xs font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-500/10 px-1.5 py-0.5 rounded">On Track</span>
        </div>
      </article>

      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Exams Passed</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-slate-900 dark:text-white">9/10</span>
          <span class="text-xs font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-500/10 px-1.5 py-0.5 rounded">90%</span>
        </div>
      </article>

      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Library Visits</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-slate-900 dark:text-white">8</span>
          <span class="text-xs font-bold text-slate-400">This Month</span>
        </div>
      </article>

      <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-5 shadow-sm transition-transform hover:scale-[1.02]">
        <p class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest">Disciplinary Score</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span class="text-3xl font-black text-slate-900 dark:text-white">8.7</span>
          <span class="text-xs font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-500/10 px-1.5 py-0.5 rounded">Out of 10</span>
        </div>
      </article>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
      
      <section class="lg:col-span-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2">
            <span class="w-8 h-8 rounded-lg bg-brand-50 dark:bg-brand-900/20 flex items-center justify-center text-brand-600 dark:text-brand-400 text-sm">
              <i class="fas fa-chart-bar"></i>
            </span>
            Subject-wise Performance
          </h2>
          <div class="flex gap-2">
            <button id="monthlyBtn" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-brand-500 text-white active-btn">Monthly</button>
            <button id="semesterBtn" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300">Semester</button>
            <button id="yearlyBtn" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300">Yearly</button>
          </div>
        </div>
        <div class="relative h-72 w-full">
          <canvas id="examTypeChart"></canvas>
        </div>
      </section>

      <section class="lg:col-span-1 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2">
            <span class="w-8 h-8 rounded-lg bg-purple-50 dark:bg-purple-900/20 flex items-center justify-center text-purple-600 dark:text-purple-400 text-sm">
              <i class="fas fa-bullseye"></i>
            </span>
            Subject Proficiency
          </h2>
        </div>
        <div class="relative h-72 w-full flex items-center justify-center">
          <canvas id="subjectRadarChart"></canvas>
        </div>
      </section>

      <!-- New Chart Section: Attendance Trends -->
      <section class="lg:col-span-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2">
            <span class="w-8 h-8 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 flex items-center justify-center text-emerald-600 dark:text-emerald-400 text-sm">
              <i class="fas fa-calendar-check"></i>
            </span>
            Monthly Attendance Trends
          </h2>
        </div>
        <div class="relative h-64 w-full">
          <canvas id="attendanceChart"></canvas>
        </div>
      </section>

    </div>

    <!-- Academic Progress Overview Section -->
    <section class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm mb-8">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2">
          <span class="w-8 h-8 rounded-lg bg-amber-50 dark:bg-amber-900/20 flex items-center justify-center text-amber-600 dark:text-amber-400 text-sm">
            <i class="fas fa-tasks"></i>
          </span>
          Academic Progress Overview
        </h2>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 class="text-sm font-bold text-slate-700 dark:text-slate-300 mb-3">Subject-wise Progress</h3>
          <div class="space-y-4">
            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm font-medium text-slate-700 dark:text-slate-300">Mathematics</span>
                <span class="text-sm font-bold text-slate-700 dark:text-slate-300">92%</span>
              </div>
              <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2">
                <div class="bg-brand-500 h-2 rounded-full" style="width: 92%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm font-medium text-slate-700 dark:text-slate-300">Physics</span>
                <span class="text-sm font-bold text-slate-700 dark:text-slate-300">85%</span>
              </div>
              <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2">
                <div class="bg-purple-500 h-2 rounded-full" style="width: 85%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm font-medium text-slate-700 dark:text-slate-300">Chemistry</span>
                <span class="text-sm font-bold text-slate-700 dark:text-slate-300">88%</span>
              </div>
              <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2">
                <div class="bg-emerald-500 h-2 rounded-full" style="width: 88%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm font-medium text-slate-700 dark:text-slate-300">Hindi</span>
                <span class="text-sm font-bold text-slate-700 dark:text-slate-300">94%</span>
              </div>
              <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2">
                <div class="bg-amber-500 h-2 rounded-full" style="width: 94%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between mb-1">
                <span class="text-sm font-medium text-slate-700 dark:text-slate-300">English</span>
                <span class="text-sm font-bold text-slate-700 dark:text-slate-300">82%</span>
              </div>
              <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2">
                <div class="bg-rose-500 h-2 rounded-full" style="width: 82%"></div>
              </div>
            </div>
          </div>
        </div>
        
        <div>
          <h3 class="text-sm font-bold text-slate-700 dark:text-slate-300 mb-3">Upcoming Deadlines</h3>
          <div class="space-y-3">
            <div class="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg">
              <div>
                <p class="font-medium text-slate-800 dark:text-slate-200">Mathematics Project</p>
                <p class="text-xs text-slate-500 dark:text-slate-400">Due in 2 days</p>
              </div>
              <span class="px-2 py-1 text-xs font-bold text-amber-800 bg-amber-100 dark:bg-amber-900/30 dark:text-amber-300 rounded">Pending</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg">
              <div>
                <p class="font-medium text-slate-800 dark:text-slate-200">Physics Practical</p>
                <p class="text-xs text-slate-500 dark:text-slate-400">Due in 5 days</p>
              </div>
              <span class="px-2 py-1 text-xs font-bold text-emerald-800 bg-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-300 rounded">Completed</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg">
              <div>
                <p class="font-medium text-slate-800 dark:text-slate-200">Chemistry Lab Work</p>
                <p class="text-xs text-slate-500 dark:text-slate-400">Due in 1 week</p>
              </div>
              <span class="px-2 py-1 text-xs font-bold text-amber-800 bg-amber-100 dark:bg-amber-900/30 dark:text-amber-300 rounded">Pending</span>
            </div>
            <div class="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg">
              <div>
                <p class="font-medium text-slate-800 dark:text-slate-200">English Exam</p>
                <p class="text-xs text-slate-500 dark:text-slate-400">In 2 weeks</p>
              </div>
              <span class="px-2 py-1 text-xs font-bold text-slate-800 bg-slate-200 dark:bg-slate-700 dark:text-slate-300 rounded">Scheduled</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm mb-8">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2">
          <span class="w-8 h-8 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 flex items-center justify-center text-emerald-600 dark:text-emerald-400 text-sm">
            <i class="fas fa-chart-line"></i>
          </span>
          Semester Growth Trend (Percentile)
        </h2>
      </div>
      <div class="relative h-64 w-full">
        <canvas id="trendChart"></canvas>
      </div>
    </section>

  </main>

  <script src="sidebar.js"></script>
  <script src="../js/theme-manager.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      
      // --- THEME AWARENESS SETUP ---
      // We need to detect Tailwind's dark mode class on the html tag to style charts
      const isDark = document.documentElement.classList.contains('dark') || 
                     (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
      
      const textColor = isDark ? '#94a3b8' : '#64748b'; // slate-400 : slate-500
      const gridColor = isDark ? '#334155' : '#e2e8f0'; // slate-700 : slate-200
      const titleColor = isDark ? '#f8fafc' : '#0f172a'; // slate-50 : slate-900

      // Common Chart Options
      const commonOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            labels: { color: textColor, font: { family: 'Inter', weight: '500' } }
          }
        },
        scales: {
          y: {
            grid: { color: gridColor, borderDash: [4, 4] },
            ticks: { color: textColor, font: { family: 'Inter' } }
          },
          x: {
            grid: { display: false },
            ticks: { color: textColor, font: { family: 'Inter' } }
          }
        }
      };

      // --- CHART 1: SUBJECT-WISE PERFORMANCE (BAR) ---
      const ctxBar = document.getElementById('examTypeChart').getContext('2d');
      let examTypeChart = new Chart(ctxBar, {
        type: 'bar',
        data: {
          labels: ['Mathematics', 'Physics', 'Chemistry', 'Computer Science', 'English'],
          datasets: [
            {
              label: 'Your Score (%)',
              data: [92, 85, 88, 94, 82],
              backgroundColor: '#3b82f6', // brand-500
              borderRadius: 6,
              barThickness: 30,
            },
            {
              label: 'Class Avg (%)',
              data: [85, 78, 82, 88, 79],
              backgroundColor: '#cbd5e1', // slate-300
              borderRadius: 6,
              barThickness: 30,
            }
          ]
        },
        options: {
          ...commonOptions,
          plugins: {
            legend: { position: 'top', align: 'end', labels: { usePointStyle: true, boxWidth: 8 } }
          }
        }
      });

      // --- CHART 2: SUBJECT PROFICIENCY (RADAR) ---
      const ctxRadar = document.getElementById('subjectRadarChart').getContext('2d');
      new Chart(ctxRadar, {
        type: 'radar',
        data: {
          labels: ['Maths', 'Physics', 'Chemistry', 'Comp Sci', 'English'],
          datasets: [{
            label: 'Proficiency',
            data: [90, 82, 85, 92, 80],
            fill: true,
            backgroundColor: 'rgba(59, 130, 246, 0.2)', // brand-500 with opacity
            borderColor: '#3b82f6',
            pointBackgroundColor: '#3b82f6',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: '#3b82f6'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              angleLines: { color: gridColor },
              grid: { color: gridColor },
              pointLabels: { color: textColor, font: { size: 11, weight: '600' } },
              ticks: { display: false, backdropColor: 'transparent' }
            }
          },
          plugins: { legend: { display: false } }
        }
      });

      // --- CHART 3: SEMESTER GROWTH TREND (LINE) ---
      const ctxLine = document.getElementById('trendChart').getContext('2d');
      
      // Gradient for Line Chart
      const gradient = ctxLine.createLinearGradient(0, 0, 0, 300);
      gradient.addColorStop(0, 'rgba(16, 185, 129, 0.2)'); // emerald
      gradient.addColorStop(1, 'rgba(16, 185, 129, 0)');

      new Chart(ctxLine, {
        type: 'line',
        data: {
          labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4', 'Sem 5'],
          datasets: [{
            label: 'Percentile',
            data: [78, 80, 83, 86, 92],
            borderColor: '#10b981', // emerald-500
            backgroundColor: gradient,
            fill: true,
            tension: 0.4, // smooth curve
            pointRadius: 4,
            pointBackgroundColor: '#10b981',
            pointBorderWidth: 2,
            pointBorderColor: '#fff'
          }]
        },
        options: {
          ...commonOptions,
          scales: {
            y: {
              ...commonOptions.scales.y,
              min: 0,
              max: 100
            },
            x: commonOptions.scales.x
          }
        }
      });

      // --- CHART 4: ATTENDANCE TRENDS (LINE) ---
      const ctxAttendance = document.getElementById('attendanceChart').getContext('2d');
      
      // Gradient for Attendance Chart
      const attendanceGradient = ctxAttendance.createLinearGradient(0, 0, 0, 300);
      attendanceGradient.addColorStop(0, 'rgba(16, 185, 129, 0.2)'); // emerald
      attendanceGradient.addColorStop(1, 'rgba(16, 185, 129, 0)');

      new Chart(ctxAttendance, {
        type: 'line',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
          datasets: [{
            label: 'Attendance %',
            data: [85, 87, 88, 89, 86, 84, 88, 90, 88, 89, 87, 88],
            borderColor: '#10b981', // emerald-500
            backgroundColor: attendanceGradient,
            fill: true,
            tension: 0.3, // smooth curve
            pointRadius: 4,
            pointBackgroundColor: '#10b981',
            pointBorderWidth: 2,
            pointBorderColor: '#fff'
          }]
        },
        options: {
          ...commonOptions,
          scales: {
            y: {
              ...commonOptions.scales.y,
              min: 80,
              max: 100
            },
            x: commonOptions.scales.x
          }
        }
      });

      // --- TIME PERIOD FILTER FUNCTIONALITY ---
      const monthlyBtn = document.getElementById('monthlyBtn');
      const semesterBtn = document.getElementById('semesterBtn');
      const yearlyBtn = document.getElementById('yearlyBtn');
      
      function updateChartTimePeriod(period) {
        let newData;
        
        switch(period) {
          case 'monthly':
            newData = {
              labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
              datasets: [
                {
                  label: 'Your Score (%)',
                  data: [85, 89, 87, 91],
                  backgroundColor: '#3b82f6',
                  borderRadius: 6,
                  barThickness: 30,
                },
                {
                  label: 'Class Avg (%)',
                  data: [79, 82, 81, 84],
                  backgroundColor: '#cbd5e1',
                  borderRadius: 6,
                  barThickness: 30,
                }
              ]
            };
            break;
          case 'semester':
            newData = {
              labels: ['Mathematics', 'Physics', 'Chemistry', 'Computer Science', 'English'],
              datasets: [
                {
                  label: 'Your Score (%)',
                  data: [90, 82, 85, 92, 80],
                  backgroundColor: '#3b82f6',
                  borderRadius: 6,
                  barThickness: 30,
                },
                {
                  label: 'Class Avg (%)',
                  data: [85, 78, 82, 88, 79],
                  backgroundColor: '#cbd5e1',
                  borderRadius: 6,
                  barThickness: 30,
                }
              ]
            };
            break;
          case 'yearly':
            newData = {
              labels: ['Q1', 'Q2', 'Q3', 'Q4'],
              datasets: [
                {
                  label: 'Your Score (%)',
                  data: [86, 88, 90, 92],
                  backgroundColor: '#3b82f6',
                  borderRadius: 6,
                  barThickness: 30,
                },
                {
                  label: 'Class Avg (%)',
                  data: [79, 82, 84, 86],
                  backgroundColor: '#cbd5e1',
                  borderRadius: 6,
                  barThickness: 30,
                }
              ]
            };
            break;
        }
        
        examTypeChart.data = newData;
        examTypeChart.update();
      }
      
      // Add event listeners to buttons
      monthlyBtn.addEventListener('click', () => {
        updateActiveButton(monthlyBtn, semesterBtn, yearlyBtn);
        updateChartTimePeriod('monthly');
      });
      
      semesterBtn.addEventListener('click', () => {
        updateActiveButton(semesterBtn, monthlyBtn, yearlyBtn);
        updateChartTimePeriod('semester');
      });
      
      yearlyBtn.addEventListener('click', () => {
        updateActiveButton(yearlyBtn, monthlyBtn, semesterBtn);
        updateChartTimePeriod('yearly');
      });
      
      function updateActiveButton(activeBtn, ...inactiveBtns) {
        // Remove active state from all buttons
        inactiveBtns.forEach(btn => {
          btn.classList.remove('bg-brand-500', 'text-white');
          btn.classList.add('bg-slate-100', 'dark:bg-slate-800', 'text-slate-700', 'dark:text-slate-300');
        });
        
        // Add active state to clicked button
        activeBtn.classList.remove('bg-slate-100', 'dark:bg-slate-800', 'text-slate-700', 'dark:text-slate-300');
        activeBtn.classList.add('bg-brand-500', 'text-white');
      }
    });
  </script>


  <!-- Toast Container -->
  <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2 max-w-sm pointer-events-none"></div>

  <script src="../js/auth-guard.js"></script>
  <script src="../js/global-search.js"></script>
  <script src="../js/notification-service.js"></script>
  <script src="../js/export-service.js"></script>

</body>
</html>