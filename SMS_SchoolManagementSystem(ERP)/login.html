<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#2563EB">
    <meta name="description" content="School Management System - Login Portal">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Login - School Management System</title>
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self' https:; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https: data:; img-src 'self' https: data:; connect-src 'self' https:;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="js/mock-auth.js"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data-service.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        },
                    }
                }
            }
        }
    </script>

    <style>
        * {
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn-press {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-press:active {
            transform: scale(0.97);
        }

        @media (max-width: 767px) {
            body {
                overflow-y: auto;
                height: auto;
            }
        }

        @media (min-width: 768px) {
            body {
                overflow: hidden;
                height: 100vh;
            }
        }

        @media (prefers-reduced-motion: reduce) {

            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>

<body class="bg-white font-sans flex flex-col md:flex-row">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2 max-w-sm pointer-events-none">
        <!-- Toasts will be injected here -->
    </div>

    <!-- LEFT HERO (Desktop only, SAS theme) -->
    <div class="hidden md:flex w-1/2 bg-brand-900 relative items-center justify-center overflow-hidden">
        <img src="https://images.unsplash.com/photo-1541339907198-e08756dedf3f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80"
            class="absolute inset-0 w-full h-full object-cover opacity-40">
        <div class="absolute inset-0 bg-gradient-to-t from-brand-900 via-brand-900/40 to-transparent"></div>

        <div class="relative z-10 text-center px-10 fade-in">
            <div
                class="w-20 h-20 bg-white/10 backdrop-blur-md rounded-2xl mx-auto flex items-center justify-center border border-white/20 mb-6 shadow-2xl">
                <i class="fas fa-school text-white text-3xl"></i>
            </div>
            <h2 class="text-4xl font-black text-white mb-2">School Management</h2>
            <p class="text-blue-100 text-lg max-w-md mx-auto">
                Secure portal access for platform owners, school admins, teachers, parents & students.
            </p>
        </div>
    </div>

    <!-- RIGHT SECTION -->
    <div class="w-full md:w-1/2 flex flex-col justify-center items-center bg-white relative">

        <!-- Mobile Header Image -->
        <div class="md:hidden w-full h-40 relative overflow-hidden shrink-0">
            <img src="https://images.unsplash.com/photo-1541339907198-e08756dedf3f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80"
                class="absolute inset-0 w-full h-full object-cover">
            <div class="absolute inset-0 bg-gradient-to-t from-white via-transparent to-brand-900/50"></div>
            <div class="absolute top-6 left-6 flex items-center gap-2">
                <div class="w-9 h-9 rounded-xl bg-white/95 p-2 shadow flex items-center justify-center">
                    <i class="fas fa-school text-brand-700"></i>
                </div>
                <span class="font-black text-white drop-shadow-md uppercase tracking-wider text-sm">SAS Portal</span>
            </div>
        </div>

        <!-- Main Login Card -->
        <div class="w-full max-w-md p-8 fade-in">

            <!-- Title -->
            <div class="mb-6 text-center md:text-left">
                <h1 class="text-3xl font-black text-slate-900 mb-2" id="roleTitle">School Management</h1>
                <p class="text-slate-500" id="roleSubtitle">Select your role to continue</p>
            </div>

            <form id="loginForm" class="space-y-5" novalidate>

                <!-- Role Selection -->
                <div>
                    <label for="userRole" class="block text-sm font-black text-slate-700 mb-1.5">
                        <i class="fas fa-user-tag mr-2 text-brand-600" id="roleLabelIcon"></i>User Role
                    </label>

                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <select id="userRole" name="userRole" required onchange="updateLoginForm()"
                            class="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm font-black focus:outline-none focus:ring-2 focus:ring-brand-500 focus:bg-white transition text-slate-800">
                            <option value="">-- Select Role --</option>
                            <option value="super-admin">Super Admin (Platform Owner)</option>
                            <option value="school-admin">School Admin (Principal/Management)</option>
                            <option value="teacher">Teacher (Staff)</option>
                            <option value="parent-student">Parent/Student</option>
                        </select>
                    </div>
                </div>

                <!-- Email Field (for Super Admin) -->
                <div id="emailField" class="hidden">
                    <label for="email" class="block text-sm font-black text-slate-700 mb-1.5">
                        <i class="fas fa-envelope mr-2 text-brand-600" id="emailIcon"></i>Email Address
                    </label>
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                            <i class="fas fa-at"></i>
                        </div>
                        <input type="email" id="email" name="email" autocomplete="email"
                            class="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:bg-white transition text-slate-800 font-black"
                            placeholder="admin@platform.com">
                    </div>
                </div>

                <!-- Phone Field (for other roles) -->
                <div id="phoneField" class="hidden">
                    <label for="phone" class="block text-sm font-black text-slate-700 mb-1.5">
                        <i class="fas fa-phone mr-2 text-brand-600" id="phoneIcon"></i>Phone Number
                    </label>
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                            <i class="fas fa-mobile-screen"></i>
                        </div>
                        <input type="tel" id="phone" name="phone" autocomplete="tel"
                            class="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:bg-white transition text-slate-800 font-black"
                            placeholder="+91 9876543210">
                    </div>
                </div>

                <!-- OTP/Password Field -->
                <div id="otpPasswordField" class="hidden">
                    <label for="otpPassword" class="block text-sm font-black text-slate-700 mb-1.5">
                        <i class="fas fa-key mr-2 text-brand-600" id="otpIcon"></i>
                        <span id="otpLabel">OTP / Password</span>
                    </label>
                    <div class="flex gap-2">
                        <div class="relative flex-1">
                            <div
                                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                                <i class="fas fa-shield-halved"></i>
                            </div>
                            <input type="text" id="otpPassword" name="otpPassword" autocomplete="one-time-code"
                                class="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:bg-white transition text-slate-800 font-black"
                                placeholder="Enter OTP or Password">
                        </div>

                        <button type="button" onclick="handleSendOTP()" id="otpButton"
                            class="px-6 py-3 rounded-xl transition-all whitespace-nowrap hidden btn-press font-black text-sm bg-brand-600 hover:bg-brand-700 text-white shadow-lg shadow-brand-200">
                            <i class="fas fa-paper-plane mr-1"></i>Send OTP
                        </button>
                    </div>
                </div>

                <!-- Password Field (for Super Admin) -->
                <div id="passwordField" class="hidden">
                    <label for="password" class="block text-sm font-black text-slate-700 mb-1.5">
                        <i class="fas fa-lock mr-2 text-brand-600" id="passwordIcon"></i>Password
                    </label>

                    <div class="relative">
                        <div
                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                            <i class="fas fa-lock"></i>
                        </div>
                        <input type="password" id="password" name="password" autocomplete="current-password"
                            class="w-full pl-10 pr-12 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:bg-white transition text-slate-800 font-black"
                            placeholder="Enter your password">
                        <button type="button" onclick="togglePassword()"
                            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-500 hover:text-slate-700 focus:outline-none"
                            aria-label="Toggle password visibility">
                            <i class="fas fa-eye" id="toggleIcon"></i>
                        </button>
                    </div>
                </div>

                <!-- Remember Me & Forgot Password -->
                <div class="flex items-center justify-between text-sm">
                    <label class="flex items-center text-slate-600 cursor-pointer">
                        <input type="checkbox" id="rememberMe"
                            class="w-4 h-4 text-brand-600 border-slate-300 rounded focus:ring-brand-500">
                        <span class="ml-2 font-black">Remember me</span>
                    </label>
                    <a href="#" class="font-black text-brand-600 hover:text-brand-700 hover:underline">Forgot
                        password?</a>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="submitButton"
                    class="w-full bg-brand-600 hover:bg-brand-700 text-white font-black py-3.5 rounded-xl shadow-lg shadow-brand-200 transition transform active:scale-95 flex items-center justify-center btn-press disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-sign-in-alt mr-2"></i><span id="submitText">Sign In</span>
                </button>

            </form>

            <!-- Footer Links -->
            <div class="mt-6 space-y-3 text-center">
                <a href="index.html" class="block text-sm text-slate-500 hover:text-brand-600 transition-colors">
                    <i class="fas fa-arrow-left mr-1"></i>Back to Home
                </a>
            </div>
        </div>

        <div class="mt-4 pb-8 md:absolute md:bottom-6 text-xs text-slate-400 text-center w-full px-4">
            Â© 2026 School Management System.
        </div>
    </div>

    <script src="js/login.js"></script>
    <script src="js/theme-manager.js"></script>
</body>

</html>