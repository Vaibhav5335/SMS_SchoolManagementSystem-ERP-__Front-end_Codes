<!DOCTYPE html>
<html lang="en" class="h-full scroll-smooth">

<head>
  <meta charset="UTF-8" />
  <title>Academic Configuration - School Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />

  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
    rel="stylesheet">

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          fontFamily: {
            sans: ['Plus Jakarta Sans', 'Inter', 'system-ui', 'sans-serif'],
            mono: ['ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', 'monospace']
          },
          colors: {
            brand: { 50: '#dcfce7', 100: '#bbf7d0', 500: '#22c55e', 600: '#16a34a', 700: '#15803d', 900: '#14532d' },
            dark: { 800: '#1e293b', 900: '#0f172a', 950: '#020617' }
          },
          animation: {
            'fade-in-up': 'fadeInUp 0.6s ease-out forwards',
            'slide-in': 'slideIn 0.4s ease-out forwards',
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          },
          keyframes: {
            fadeInUp: {
              '0%': { opacity: '0', transform: 'translateY(15px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            },
            slideIn: {
              '0%': { opacity: '0', transform: 'translateX(-10px)' },
              '100%': { opacity: '1', transform: 'translateX(0)' },
            }
          }
        }
      }
    }
  </script>

  <style>
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }

    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    *:focus-visible {
      outline: 2px solid #22c55e;
      outline-offset: 2px;
    }

    /* Glassmorphism utilities */
    .glass {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .dark .glass {
      background: rgba(15, 23, 42, 0.6);
    }

    /* Add left padding to main content area */
    @media (min-width: 1024px) {
      #mainContent {
        padding-left: 1rem !important;
      }
    }
  </style>
</head>

<body
  class="min-h-screen bg-slate-50 text-slate-800 antialiased dark:bg-[#020617] dark:text-slate-200 transition-colors duration-300">
  <div id="appShell"></div>

  <main id="academicConfigMain" class="hidden w-full max-w-[1600px] mx-auto py-8 animate-fade-in-up">
    <br>
    <header class="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-8">
      <div>
        <div class="flex items-center gap-2 mb-2">
          <span class="text-xs font-bold uppercase tracking-widest text-slate-500 dark:text-slate-400">Academic
            Configuration</span>
        </div>
        <h1 class="text-3xl sm:text-4xl font-extrabold text-slate-900 dark:text-white tracking-tight">
          Academic Setup
        </h1>
        <p class="text-base text-slate-600 dark:text-slate-400 mt-2">
          Configure timetables, academic calendar, and fee structures
        </p>
      </div>

      <div class="flex items-center gap-3">
        <!-- Dark mode toggle is now in sidebar header -->
        <button onclick="saveAllChanges()"
          class="flex items-center gap-2 bg-gradient-to-r from-brand-500 to-emerald-600 hover:from-brand-600 hover:to-emerald-700 text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all active:scale-95">
          <i class="fas fa-save"></i>
          <span>Save All</span>
        </button>
      </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
      <!-- Sidebar Navigation -->
      <div class="lg:col-span-1">
        <div
          class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-sm p-4 sticky top-4">
          <h3 class="font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2">
            <i class="fas fa-cog text-brand-500"></i>Configuration
          </h3>
          <nav class="space-y-1">
            <a href="#timetable" onclick="showSection('timetable')"
              class="config-nav block px-4 py-3 rounded-xl bg-brand-50 dark:bg-brand-900/10 text-brand-700 dark:text-brand-400 font-bold border border-brand-200 dark:border-brand-800/50 flex items-center gap-2">
              <i class="fas fa-clock"></i>
              <span>Timetable</span>
            </a>
            <a href="#calendar" onclick="showSection('calendar')"
              class="config-nav block px-4 py-3 rounded-xl text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800/50 font-bold flex items-center gap-2">
              <i class="fas fa-calendar"></i>
              <span>Academic Calendar</span>
            </a>
            <a href="#fees" onclick="showSection('fees')"
              class="config-nav block px-4 py-3 rounded-xl text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800/50 font-bold flex items-center gap-2">
              <i class="fas fa-rupee-sign"></i>
              <span>Fee Structure</span>
            </a>
          </nav>
        </div>
      </div>

      <!-- Content Area -->
      <div class="lg:col-span-3 space-y-6">
        <!-- Timetable Section -->
        <div id="timetable"
          class="config-section bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-sm p-6">
          <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6">
            <h2 class="text-2xl font-extrabold text-slate-900 dark:text-white">Class Timetable</h2>
            <div class="flex gap-2">
              <select
                class="px-4 py-2.5 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
                <option>Class 5A</option>
                <option>Class 5B</option>
                <option>Class 8A</option>
                <option>Class 8B</option>
              </select>
              <button onclick="addTimeSlot()"
                class="bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 px-4 py-2.5 rounded-xl font-bold transition-all flex items-center gap-1.5">
                <i class="fas fa-plus"></i>
                <span>Add Slot</span>
              </button>
            </div>
          </div>

          <div class="overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-800">
            <table class="w-full">
              <thead class="bg-slate-50 dark:bg-slate-800/50">
                <tr>
                  <th
                    class="px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                    Time</th>
                  <th
                    class="px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                    Monday</th>
                  <th
                    class="px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                    Tuesday</th>
                  <th
                    class="px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                    Wednesday</th>
                  <th
                    class="px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                    Thursday</th>
                  <th
                    class="px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                    Friday</th>
                  <th
                    class="px-4 py-3 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                    Actions</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-slate-200 dark:divide-slate-800">
                <tr class="hover:bg-slate-50 dark:hover:bg-slate-800/30">
                  <td class="px-4 py-3 font-bold text-slate-900 dark:text-white">9:00 - 9:45</td>
                  <td class="px-4 py-3">
                    <input type="text" value="Mathematics"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="English"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="Science"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="Mathematics"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="English"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <button onclick="deleteTimeSlot(this)"
                      class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                      <i class="fas fa-trash text-xs"></i>
                    </button>
                  </td>
                </tr>
                <tr class="hover:bg-slate-50 dark:hover:bg-slate-800/30">
                  <td class="px-4 py-3 font-bold text-slate-900 dark:text-white">9:45 - 10:30</td>
                  <td class="px-4 py-3">
                    <input type="text" value="Science"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="Mathematics"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="English"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="Science"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <input type="text" value="Mathematics"
                      class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                  </td>
                  <td class="px-4 py-3">
                    <button onclick="deleteTimeSlot(this)"
                      class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                      <i class="fas fa-trash text-xs"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="mt-4 flex justify-end">
            <button onclick="saveTimetable()"
              class="bg-gradient-to-r from-brand-500 to-emerald-600 hover:from-brand-600 hover:to-emerald-700 text-white px-5 py-2.5 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all active:scale-95 flex items-center gap-2">
              <i class="fas fa-save"></i>
              <span>Save Timetable</span>
            </button>
          </div>
        </div>

        <!-- Calendar Section -->
        <div id="calendar"
          class="config-section hidden bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-sm p-6">
          <h2 class="text-2xl font-extrabold text-slate-900 dark:text-white mb-6">Academic Calendar</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Academic Year</label>
              <input type="text" value="2024-2025"
                class="w-full px-4 py-3 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
            </div>
            <div>
              <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Session Start Date</label>
              <input type="date"
                class="w-full px-4 py-3 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
            </div>
            <div>
              <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Session End Date</label>
              <input type="date"
                class="w-full px-4 py-3 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
            </div>
            <div>
              <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Working Days</label>
              <select
                class="w-full px-4 py-3 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
                <option>Monday to Friday</option>
                <option>Monday to Saturday</option>
              </select>
            </div>
          </div>

          <div class="mt-8">
            <div class="flex justify-between items-center mb-4">
              <h3 class="font-bold text-slate-900 dark:text-white">Holidays & Events</h3>
              <button onclick="addHoliday()"
                class="bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 px-4 py-2 rounded-xl font-bold transition-all flex items-center gap-1.5">
                <i class="fas fa-plus"></i>
                <span>Add Holiday</span>
              </button>
            </div>
            <div class="space-y-3" id="holidaysList">
              <div
                class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/30 rounded-xl border border-slate-200 dark:border-slate-700">
                <div>
                  <p class="font-bold text-slate-900 dark:text-white">Diwali</p>
                  <p class="text-sm text-slate-600 dark:text-slate-400">Nov 1, 2024 - Nov 5, 2024</p>
                </div>
                <button onclick="deleteHoliday(this)"
                  class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                  <i class="fas fa-trash text-xs"></i>
                </button>
              </div>
            </div>
          </div>

          <div class="mt-6 flex justify-end">
            <button onclick="saveCalendar()"
              class="bg-gradient-to-r from-brand-500 to-emerald-600 hover:from-brand-600 hover:to-emerald-700 text-white px-5 py-2.5 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all active:scale-95 flex items-center gap-2">
              <i class="fas fa-save"></i>
              <span>Save Calendar</span>
            </button>
          </div>
        </div>

        <!-- Fee Structure Section -->
        <div id="fees"
          class="config-section hidden bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-sm p-6">
          <h2 class="text-2xl font-extrabold text-slate-900 dark:text-white mb-6">Fee Structure</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Select Class</label>
              <select
                class="w-full px-4 py-3 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
                <option>All Classes</option>
                <option>Class 5A</option>
                <option>Class 5B</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Fee Payment Cycle</label>
              <select
                class="w-full px-4 py-3 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white">
                <option>Monthly</option>
                <option>Quarterly</option>
                <option>Half-Yearly</option>
                <option>Annual</option>
              </select>
            </div>
          </div>

          <div class="border border-slate-200 dark:border-slate-800 rounded-xl p-4 mb-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="font-bold text-slate-900 dark:text-white">Fee Components</h3>
              <button onclick="addFeeComponent()"
                class="bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 px-4 py-2 rounded-xl font-bold transition-all flex items-center gap-1.5">
                <i class="fas fa-plus"></i>
                <span>Add Component</span>
              </button>
            </div>
            <div class="space-y-3" id="feeComponents">
              <div
                class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/30 rounded-xl border border-slate-200 dark:border-slate-700">
                <div>
                  <p class="font-bold text-slate-900 dark:text-white">Tuition Fee</p>
                  <p class="text-sm text-slate-600 dark:text-slate-400">Monthly</p>
                </div>
                <div class="flex items-center gap-2">
                  <span class="font-bold text-slate-900 dark:text-white">₹5,000</span>
                  <button onclick="editFee(this)"
                    class="w-8 h-8 rounded-lg bg-brand-100 dark:bg-brand-900/20 hover:bg-brand-200 dark:hover:bg-brand-800/30 text-brand-700 dark:text-brand-400 flex items-center justify-center transition-all">
                    <i class="fas fa-edit text-xs"></i>
                  </button>
                  <button onclick="deleteFee(this)"
                    class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                    <i class="fas fa-trash text-xs"></i>
                  </button>
                </div>
              </div>
              <div
                class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/30 rounded-xl border border-slate-200 dark:border-slate-700">
                <div>
                  <p class="font-bold text-slate-900 dark:text-white">Library Fee</p>
                  <p class="text-sm text-slate-600 dark:text-slate-400">Annual</p>
                </div>
                <div class="flex items-center gap-2">
                  <span class="font-bold text-slate-900 dark:text-white">₹2,000</span>
                  <button onclick="editFee(this)"
                    class="w-8 h-8 rounded-lg bg-brand-100 dark:bg-brand-900/20 hover:bg-brand-200 dark:hover:bg-brand-800/30 text-brand-700 dark:text-brand-400 flex items-center justify-center transition-all">
                    <i class="fas fa-edit text-xs"></i>
                  </button>
                  <button onclick="deleteFee(this)"
                    class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                    <i class="fas fa-trash text-xs"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="flex justify-end">
            <button onclick="saveFeeStructure()"
              class="bg-gradient-to-r from-brand-500 to-emerald-600 hover:from-brand-600 hover:to-emerald-700 text-white px-5 py-2.5 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all active:scale-95 flex items-center gap-2">
              <i class="fas fa-save"></i>
              <span>Save Fee Structure</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Toast Container -->
  <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2 max-w-sm pointer-events-none"></div>

  <!-- Data & Error Management -->
  <script src="../js/utils.js"></script>
  <script src="../js/auth-guard.js"></script>
  <script src="../js/common-features.js"></script>
  <script src="../js/theme-manager.js"></script>
  <script src="sidebar.js"></script>

  <script>
    'use strict';

    // Wait for sidebar to be injected, then move content into mainContent
    function initAcademicConfig() {
      const academicConfigMain = document.getElementById('academicConfigMain');
      const mainContent = document.getElementById('mainContent');

      if (academicConfigMain && mainContent) {
        mainContent.innerHTML = academicConfigMain.innerHTML;
        academicConfigMain.remove();
        academicConfigMain.classList.remove('hidden');

        // Now run academic config logic
        runAcademicConfigLogic();
      } else {
        setTimeout(initAcademicConfig, 100);
      }
    }

    function runAcademicConfigLogic() {
      // Check authentication
      if (typeof SessionManager !== 'undefined' && !SessionManager.isAuthenticated()) {
        window.location.href = '../login.html';
        return;
      }

      // Load initial configuration data
      loadConfigData();
    }

    async function loadConfigData() {
      try {
        // In a real app, fetch from API
        NotificationManager.success('Configuration data loaded successfully!');
      } catch (error) {
        console.error('Config data error:', error);
        NotificationManager.warning('Using test configuration data.');
      }
    }

    function showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll('.config-section').forEach(section => {
        section.classList.add('hidden');
      });

      // Show selected section
      const section = document.getElementById(sectionId);
      if (section) {
        section.classList.remove('hidden');
      }

      // Update navigation
      document.querySelectorAll('.config-nav').forEach(nav => {
        nav.classList.remove('bg-brand-50', 'dark:bg-brand-900/10', 'text-brand-700', 'dark:text-brand-400', 'border-brand-200', 'dark:border-brand-800/50');
        nav.classList.add('text-slate-700', 'dark:text-slate-300', 'hover:bg-slate-100', 'dark:hover:bg-slate-800/50');
      });

      if (event && event.target) {
        const targetBtn = event.target.closest('.config-nav');
        if (targetBtn) {
          targetBtn.classList.add('bg-brand-50', 'dark:bg-brand-900/10', 'text-brand-700', 'dark:text-brand-400', 'border-brand-200', 'dark:border-brand-800/50');
          targetBtn.classList.remove('text-slate-700', 'dark:text-slate-300', 'hover:bg-slate-100', 'dark:hover:bg-slate-800/50');
        }
      }
    }

    function saveAllChanges() {
      NotificationManager.success('All changes saved successfully!');
    }

    // Timetable functions
    function addTimeSlot() {
      const tableBody = document.querySelector('#timetable tbody');
      const newRow = document.createElement('tr');
      newRow.className = 'hover:bg-slate-50 dark:hover:bg-slate-800/30';
      newRow.innerHTML = `
                <td class="px-4 py-3">
                    <input type="text" placeholder="Time" 
                        class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                </td>
                <td class="px-4 py-3">
                    <input type="text" placeholder="Subject" 
                        class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                </td>
                <td class="px-4 py-3">
                    <input type="text" placeholder="Subject" 
                        class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                </td>
                <td class="px-4 py-3">
                    <input type="text" placeholder="Subject" 
                        class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                </td>
                <td class="px-4 py-3">
                    <input type="text" placeholder="Subject" 
                        class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                </td>
                <td class="px-4 py-3">
                    <input type="text" placeholder="Subject" 
                        class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-brand-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500">
                </td>
                <td class="px-4 py-3">
                    <button onclick="deleteTimeSlot(this)" class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                        <i class="fas fa-trash text-xs"></i>
                    </button>
                </td>
            `;
      tableBody.appendChild(newRow);
      NotificationManager.info('New time slot added');
    }

    function deleteTimeSlot(button) {
      if (confirm('Are you sure you want to delete this time slot?')) {
        button.closest('tr').remove();
        NotificationManager.success('Time slot deleted');
      }
    }

    function saveTimetable() {
      NotificationManager.success('Timetable saved successfully!');
    }

    // Calendar functions
    function addHoliday() {
      const holidaysList = document.getElementById('holidaysList');
      const newHoliday = document.createElement('div');
      newHoliday.className = 'flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/30 rounded-xl border border-slate-200 dark:border-slate-700';
      newHoliday.innerHTML = `
                <div>
                    <input type="text" placeholder="Holiday Name" 
                        class="font-bold text-slate-900 dark:text-white bg-transparent border-none focus:ring-0 p-0 w-32">
                    <input type="text" placeholder="Date Range" 
                        class="text-sm text-slate-600 dark:text-slate-400 bg-transparent border-none focus:ring-0 p-0 w-40">
                </div>
                <button onclick="deleteHoliday(this)" class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                    <i class="fas fa-trash text-xs"></i>
                </button>
            `;
      holidaysList.appendChild(newHoliday);
      NotificationManager.info('New holiday added');
    }

    function deleteHoliday(button) {
      if (confirm('Are you sure you want to delete this holiday?')) {
        button.closest('div').remove();
        NotificationManager.success('Holiday deleted');
      }
    }

    function saveCalendar() {
      NotificationManager.success('Academic calendar saved successfully!');
    }

    // Fee structure functions
    function addFeeComponent() {
      const feeComponents = document.getElementById('feeComponents');
      const newComponent = document.createElement('div');
      newComponent.className = 'flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/30 rounded-xl border border-slate-200 dark:border-slate-700';
      newComponent.innerHTML = `
                <div>
                    <input type="text" placeholder="Fee Name" 
                        class="font-bold text-slate-900 dark:text-white bg-transparent border-none focus:ring-0 p-0 w-32">
                    <input type="text" placeholder="Frequency" 
                        class="text-sm text-slate-600 dark:text-slate-400 bg-transparent border-none focus:ring-0 p-0 w-20">
                </div>
                <div class="flex items-center gap-2">
                    <input type="text" placeholder="Amount" 
                        class="font-bold text-slate-900 dark:text-white bg-transparent border-none focus:ring-0 p-0 w-20 text-right">
                    <button onclick="editFee(this)" class="w-8 h-8 rounded-lg bg-brand-100 dark:bg-brand-900/20 hover:bg-brand-200 dark:hover:bg-brand-800/30 text-brand-700 dark:text-brand-400 flex items-center justify-center transition-all">
                        <i class="fas fa-edit text-xs"></i>
                    </button>
                    <button onclick="deleteFee(this)" class="w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-400 flex items-center justify-center transition-all">
                        <i class="fas fa-trash text-xs"></i>
                    </button>
                </div>
            `;
      feeComponents.appendChild(newComponent);
      NotificationManager.info('New fee component added');
    }

    function editFee(button) {
      NotificationManager.info('Edit fee component feature coming soon');
    }

    function deleteFee(button) {
      if (confirm('Are you sure you want to delete this fee component?')) {
        button.closest('div').remove();
        NotificationManager.success('Fee component deleted');
      }
    }

    function saveFeeStructure() {
      NotificationManager.success('Fee structure saved successfully!');
    }

    // Start initialization when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initAcademicConfig);
    } else {
      initAcademicConfig();
    }

    // Initialize with first section
    showSection('timetable');
  </script>
</body>

</html>